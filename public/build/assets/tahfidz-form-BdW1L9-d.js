import{x as M,r as y,j as a}from"./app-gjtAn5El.js";import{B as n}from"./button-By04tjtr.js";import{d as x,C as j,b as u,a as A,e as T,c as L}from"./card-DKLrfEzB.js";import{d as R,e as K,f as S,b as B,D as I,c as z}from"./dropdown-menu-BAeTQUvr.js";import{I as H}from"./input-E0N1tJe0.js";import{P as F,a as $,b as U}from"./popover-CjkxC4vb.js";import{T as _,a as G,b as P,c as l,d as J,e as m}from"./table-yvOoUD12.js";import{T as O}from"./textarea-D-jL7dtP.js";import{A as Q}from"./app-layout-CyIDmO2b.js";import{c as q}from"./enums-Cfr99xRN.js";import{b as V,E as W}from"./mockup-data-DfUV2qM1.js";import{e as X,j as Y}from"./utils-DMfQtvov.js";import{t as D}from"./index-dz1GIDOc.js";import{T as Z}from"./trash-2-D1rAzIWN.js";import{P as aa}from"./plus-B_Hgv4Gb.js";import{C as sa}from"./check-DMlgC_tD.js";/* empty css            */import"./index-DvkuFPqW.js";import"./index-B26Os_Ix.js";import"./index-DJU7MOx1.js";import"./index-C5BeI9rp.js";import"./index-BGrkkWQn.js";import"./index-D2y8B7B1.js";import"./index-DAJp9f9j.js";import"./index-CG6E1-pS.js";import"./index-Ds6vXjzw.js";import"./index-BCWsKhRR.js";import"./index-DB7pJufW.js";import"./index-C8i6XsBO.js";import"./heading-B5hewX3j.js";import"./sonner-s7mZx4gV.js";import"./theme-toggler-B94cFpnA.js";import"./createLucideIcon-CZrFTrU_.js";import"./use-mobile-afvKzG1S.js";import"./sheet-D5JKOrEt.js";import"./index-CvsYew9q.js";import"./x-urWu1Yro.js";import"./index-CjpL7NZ4.js";import"./scroll-area-0ziMWaFD.js";import"./index-BdQq_4o_.js";import"./use-page-props-Dys7tNtm.js";import"./app-logo-icon-B6rOIGf1.js";import"./use-can-BGZed4-P.js";import"./avatar-Bt3aX9bp.js";import"./index-LXLBVjJ3.js";import"./user-plus-Bl3UXJQZ.js";import"./folder-VfI3PMER.js";import"./chevron-right-DA1hL8DA.js";import"./tahun-ajaran-list-dialog-DsZFGrkY.js";import"./checkbox-vYkRxN5_.js";import"./index-MK6_u-ia.js";import"./dialog-DGndaXLp.js";import"./tahun-ajaran-form-sheet-BCIeralD.js";import"./form-control-C5DpwnMZ.js";import"./label-CQT2szKQ.js";import"./select-DSe88Jj7.js";import"./chevron-down-CEfrTvmX.js";import"./square-pen-B7taPjcQ.js";const ns=({rapor:r,siswa:c,tahunajaran:N})=>{var g,b,C,v;const{data:o,setData:d,put:f}=M({siswa_id:r.siswa.id,jenis:r.jenis,tahunajaran_id:r.tahunajaran.id,data:r.data??V}),p=y.useCallback(()=>{f(route("rapor.update",r.id),{preserveScroll:!0,onSuccess:()=>{D.success("Rapor berhasil disimpan")},onError:s=>D.error(X(s))})},[f,r.id]);y.useEffect(()=>{const s=i=>{(i.ctrlKey||i.metaKey)&&i.key==="s"&&(i.preventDefault(),p())};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[p]);const w=Y(q.filter(s=>[1,28,29,30].includes(s.juz)),"juz");return a.jsx(Q,{title:"Rapor Perkembangan",description:`${(g=r.siswa)==null?void 0:g.name} kelas ${(b=r.siswa.kelas)==null?void 0:b.name} tahun ajaran ${(C=r.tahunajaran)==null?void 0:C.name}`,actions:a.jsxs(a.Fragment,{children:[a.jsx(n,{asChild:!0,children:a.jsxs("a",{href:route("rapor.stream",r.id),children:[a.jsx(W,{}),"Preview PDF"]})}),a.jsxs(n,{onClick:p,className:"fixed right-6 bottom-6",children:[a.jsx(sa,{}),"Simpan"]})]}),children:a.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[a.jsxs(x,{className:"text-center text-3xl uppercase",children:["LAPORAN PERKEMBANGAN HAFALAN AL-QURAN PKBM AL-MADINAH SEMESTER ",N.semester," TAHUN AJARAN ",N.name]}),a.jsx(j,{children:a.jsx(u,{children:a.jsxs("dl",{className:"space-y-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"Nama siswa"}),a.jsx("dd",{className:"w-2/3",children:c.name})]}),a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"Kelas"}),a.jsx("dd",{className:"w-2/3",children:(v=c.kelas)==null?void 0:v.name})]}),a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"Usia"}),a.jsx("dd",{className:"w-2/3",children:c.umur??""})]}),a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"NIS/NISN"}),a.jsx("dd",{className:"w-2/3",children:c.nisn})]})]})})}),a.jsxs(j,{children:[a.jsxs(A,{children:[a.jsx(x,{children:"Data rapor tahfidz"}),a.jsx(T,{children:"Isi data tahfidz siswa"})]}),a.jsx(u,{children:a.jsxs(_,{children:[a.jsx(G,{children:a.jsxs(P,{children:[a.jsx(l,{children:"No"}),a.jsx(l,{children:"Nama surah"}),a.jsx(l,{children:"Kemampuan yang dicapai"}),a.jsx(l,{children:"Keterangan ayat"}),a.jsx(l,{children:"Action"})]})}),a.jsx(J,{children:o.data.penilaian.map((s,i)=>a.jsxs(P,{children:[a.jsx(m,{children:i+1}),a.jsx(m,{children:a.jsxs(R,{children:[a.jsx(K,{asChild:!0,children:s.surah==""?a.jsx(n,{variant:"ghost",className:"opacity-50",children:"Pilih surah"}):a.jsx(n,{variant:"ghost",children:s.surah===""?"Pilih surah":s.surah})}),a.jsx(S,{side:"bottom",align:"start",children:Object.keys(w).sort((t,e)=>Number(t)-Number(e)).map(t=>a.jsxs(B,{children:[a.jsxs(I,{children:["Juz ",t]}),w[t].map(e=>a.jsxs(z,{inset:!0,onClick:()=>{const h=o.data.penilaian.map((k,E)=>E===i?{...k,surah:`${e.surah} (${e.id})`}:k);d("data.penilaian",h)},children:[e.surah," (",e.id,")"]},e.id))]},t))})]})}),a.jsx(m,{children:s.keterangan}),a.jsx(m,{children:a.jsxs(F,{children:[a.jsx($,{asChild:!0,children:a.jsx(n,{variant:"ghost",size:"icon",children:s.ayat})}),a.jsx(U,{side:"bottom",align:"start",className:"w-24",children:a.jsx(H,{className:"text-center",value:s.ayat,onChange:t=>d("data.penilaian",o.data.penilaian.map((e,h)=>h===i?{...e,ayat:t.target.value===""?0:Number(t.target.value)}:e))})})]})}),a.jsx(m,{children:a.jsx(n,{variant:"ghost",size:"icon",onClick:()=>d("data.penilaian",o.data.penilaian.filter((t,e)=>e!==i)),children:a.jsx(Z,{})})})]}))})]})}),a.jsx(L,{children:a.jsxs(n,{onClick:()=>d("data.penilaian",[...o.data.penilaian,{surah:"",ayat:0,keterangan:"Berkembang"}]),children:[a.jsx(aa,{}),"Tambah baris"]})})]}),a.jsxs(j,{children:[a.jsxs(A,{children:[a.jsx(x,{children:"Catatan rapor"}),a.jsx(T,{children:"Tulis catatan untuk siswa"})]}),a.jsx(u,{children:a.jsx(O,{value:o.data.catatan,onChange:s=>d("data.catatan",s.target.value),className:"min-h-24"})})]})]})})};export{ns as default};
