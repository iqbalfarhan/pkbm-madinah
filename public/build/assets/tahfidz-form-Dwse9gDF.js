import{x as M,r as y,j as a}from"./app-DpfdW_r7.js";import{B as n}from"./button-DTT2fkdQ.js";import{b as x,C as j,d as u,a as A,c as T,e as L}from"./card-CHA020O5.js";import{d as R,e as K,f as S,b as B,D as I,c as z}from"./dropdown-menu-DWcDuiNs.js";import{I as H}from"./input-BS3ehIaV.js";import{P as F,a as $,b as U}from"./popover-C2UhExVz.js";import{T as _,a as G,b as P,c as l,d as J,e as m}from"./table-BAlc14Fx.js";import{T as O}from"./textarea-nH1vs3LU.js";import{A as Q}from"./app-layout-Cq5dHlQf.js";import{s as q}from"./enums-CLZFyCUg.js";import{b as V,E as W}from"./mockup-data-ByM-yVw5.js";import{e as X,h as Y}from"./utils-CuXvM_eT.js";import{t as D}from"./index-B-v_Mcin.js";import{T as Z}from"./trash-2-BsUn5BQh.js";import{P as aa}from"./plus-C99iL4NZ.js";import{C as sa}from"./check-Qol8Cez_.js";/* empty css            */import"./index-Bn78W0G-.js";import"./index-mHq7RGbL.js";import"./index-D9IwJIAp.js";import"./index-Brdl_M0l.js";import"./index-BUbDSQ73.js";import"./index-NApHEZtM.js";import"./index-BWg45J-h.js";import"./index-Co76VJT-.js";import"./index-C7d_I9YW.js";import"./index-Cs2VM941.js";import"./index-IJoEPwWj.js";import"./index-CAPfhsIC.js";import"./heading-C4yjbGcH.js";import"./sonner-0KgaSfDc.js";import"./theme-toggler-BqCSg1BF.js";import"./use-mobile-2vCoIvR7.js";import"./sheet-C-XpxoHV.js";import"./index-q-qQhBSK.js";import"./x-C3M5dEuO.js";import"./createLucideIcon-abM9t_Dn.js";import"./index-C91Jes3I.js";import"./scroll-area-CoJ17A8p.js";import"./index-BdQq_4o_.js";import"./use-page-props-DTWtzoxv.js";import"./app-logo-icon-BEcDBf9R.js";import"./use-can-BWiZj679.js";import"./avatar-BmS3oxRd.js";import"./index-eCN9uh3H.js";import"./user-plus-gpBx4cAG.js";import"./folder-ClgR4eJH.js";import"./chevron-right-BbmPEhFC.js";import"./tahun-ajaran-list-dialog-BDwNG33G.js";import"./checkbox-DOw6s7Kg.js";import"./index-DGwOj2gT.js";import"./dialog-v1EtXj0r.js";import"./tahun-ajaran-form-sheet-BXcFtP19.js";import"./form-control-D1mjSVkY.js";import"./label-CwNgEzzR.js";import"./select-LnSn0gPA.js";import"./chevron-down-CBu8Xe3p.js";import"./square-pen-CuKycSN7.js";const ns=({rapor:r,siswa:c,tahunajaran:N})=>{var g,b,C,v;const{data:o,setData:d,put:f}=M({siswa_id:r.siswa.id,jenis:r.jenis,tahunajaran_id:r.tahunajaran.id,data:r.data??V}),p=y.useCallback(()=>{f(route("rapor.update",r.id),{preserveScroll:!0,onSuccess:()=>{D.success("Rapor berhasil disimpan")},onError:s=>D.error(X(s))})},[f,r.id]);y.useEffect(()=>{const s=i=>{(i.ctrlKey||i.metaKey)&&i.key==="s"&&(i.preventDefault(),p())};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[p]);const w=Y(q.filter(s=>[1,28,29,30].includes(s.juz)),"juz");return a.jsx(Q,{title:"Rapor Perkembangan",description:`${(g=r.siswa)==null?void 0:g.name} kelas ${(b=r.siswa.kelas)==null?void 0:b.name} tahun ajaran ${(C=r.tahunajaran)==null?void 0:C.name}`,actions:a.jsxs(a.Fragment,{children:[a.jsx(n,{asChild:!0,children:a.jsxs("a",{href:route("rapor.stream",r.id),children:[a.jsx(W,{}),"Preview PDF"]})}),a.jsxs(n,{onClick:p,className:"fixed right-6 bottom-6",children:[a.jsx(sa,{}),"Simpan"]})]}),children:a.jsxs("div",{className:"mx-auto max-w-4xl space-y-6",children:[a.jsxs(x,{className:"text-center text-3xl uppercase",children:["LAPORAN PERKEMBANGAN HAFALAN AL-QURAN PKBM AL-MADINAH SEMESTER ",N.semester," TAHUN AJARAN ",N.name]}),a.jsx(j,{children:a.jsx(u,{children:a.jsxs("dl",{className:"space-y-2",children:[a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"Nama siswa"}),a.jsx("dd",{className:"w-2/3",children:c.name})]}),a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"Kelas"}),a.jsx("dd",{className:"w-2/3",children:(v=c.kelas)==null?void 0:v.name})]}),a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"Usia"}),a.jsx("dd",{className:"w-2/3",children:c.umur??""})]}),a.jsxs("div",{className:"flex",children:[a.jsx("dt",{className:"w-1/3",children:"NIS/NISN"}),a.jsx("dd",{className:"w-2/3",children:c.nisn})]})]})})}),a.jsxs(j,{children:[a.jsxs(A,{children:[a.jsx(x,{children:"Data rapor tahfidz"}),a.jsx(T,{children:"Isi data tahfidz siswa"})]}),a.jsx(u,{children:a.jsxs(_,{children:[a.jsx(G,{children:a.jsxs(P,{children:[a.jsx(l,{children:"No"}),a.jsx(l,{children:"Nama surah"}),a.jsx(l,{children:"Kemampuan yang dicapai"}),a.jsx(l,{children:"Keterangan ayat"}),a.jsx(l,{children:"Action"})]})}),a.jsx(J,{children:o.data.penilaian.map((s,i)=>a.jsxs(P,{children:[a.jsx(m,{children:i+1}),a.jsx(m,{children:a.jsxs(R,{children:[a.jsx(K,{asChild:!0,children:s.surah==""?a.jsx(n,{variant:"ghost",className:"opacity-50",children:"Pilih surah"}):a.jsx(n,{variant:"ghost",children:s.surah===""?"Pilih surah":s.surah})}),a.jsx(S,{side:"bottom",align:"start",children:Object.keys(w).sort((t,e)=>Number(t)-Number(e)).map(t=>a.jsxs(B,{children:[a.jsxs(I,{children:["Juz ",t]}),w[t].map(e=>a.jsxs(z,{inset:!0,onClick:()=>{const h=o.data.penilaian.map((k,E)=>E===i?{...k,surah:`${e.surah} (${e.id})`}:k);d("data.penilaian",h)},children:[e.surah," (",e.id,")"]},e.id))]},t))})]})}),a.jsx(m,{children:s.keterangan}),a.jsx(m,{children:a.jsxs(F,{children:[a.jsx($,{asChild:!0,children:a.jsx(n,{variant:"ghost",size:"icon",children:s.ayat})}),a.jsx(U,{side:"bottom",align:"start",className:"w-24",children:a.jsx(H,{className:"text-center",value:s.ayat,onChange:t=>d("data.penilaian",o.data.penilaian.map((e,h)=>h===i?{...e,ayat:t.target.value===""?0:Number(t.target.value)}:e))})})]})}),a.jsx(m,{children:a.jsx(n,{variant:"ghost",size:"icon",onClick:()=>d("data.penilaian",o.data.penilaian.filter((t,e)=>e!==i)),children:a.jsx(Z,{})})})]}))})]})}),a.jsx(L,{children:a.jsxs(n,{onClick:()=>d("data.penilaian",[...o.data.penilaian,{surah:"",ayat:0,keterangan:"Berkembang"}]),children:[a.jsx(aa,{}),"Tambah baris"]})})]}),a.jsxs(j,{children:[a.jsxs(A,{children:[a.jsx(x,{children:"Catatan rapor"}),a.jsx(T,{children:"Tulis catatan untuk siswa"})]}),a.jsx(u,{children:a.jsx(O,{value:o.data.catatan,onChange:s=>d("data.catatan",s.target.value),className:"min-h-24"})})]})]})})};export{ns as default};
